! function(a) {
    a.fn.unveil = function(b, c) {
        function j() {
            var b = h.filter(function() {
                var b = a(this);
                if (!b.is(":hidden")) {
                    var c = d.scrollTop(),
                        f = c + d.height(),
                        g = b.offset().top,
                        h = g + b.height();
                    return h >= c - e && f + e >= g
                }
            });
            i = b.trigger("unveil"), h = h.not(i)
        }

        function k(b, d) {
            a.get(b, function() {
                d.setAttribute("src", b), "function" == typeof c && c.call(d)
            })
        }
        var i, d = a(window),
            e = b || 0,
            f = window.devicePixelRatio > 1,
            g = f ? "data-src-retina" : "data-src",
            h = this;
        return this.one("unveil", function() {
            var a = this.getAttribute(g);
            a = a || this.getAttribute("data-src"), element = this, a && k(a, this)
        }), d.scroll(j), d.resize(j), j(), this
    }
}(window.jQuery || window.Zepto);
